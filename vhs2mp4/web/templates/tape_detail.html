{% extends "layout.html" %}

{% block content %}
<section>
  <h2>Tape Details</h2>
  {% if not tape %}
    <p>Tape not found.</p>
  {% else %}
    <article>
      <h3>{{ tape.title }}</h3>
      <p><strong>Tape ID:</strong> {{ tape.tape_code or "—" }}</p>
      <p><strong>Status:</strong> {{ tape.status or "New" }}</p>
      <p><strong>Created:</strong> {{ tape.created_at }}</p>
      <p><strong>Source Label:</strong> {{ tape.source_label or "—" }}</p>
      <p><strong>Date Type:</strong> {{ tape.date_type }}</p>
      <p><strong>Exact Date:</strong> {{ tape.date_exact or "—" }}</p>
      <p><strong>Date Range:</strong> {{ tape.date_start or "—" }} → {{ tape.date_end or "—" }}</p>
      <p><strong>Date Locked:</strong> {{ "Yes" if tape.date_locked else "No" }}</p>
      <h4>Raw Media</h4>
      {% if tape.raw_filename %}
        <p><strong>Raw File:</strong> {{ tape.raw_filename }}</p>
        <p><strong>Ingested At:</strong> {{ tape.ingested_at or "—" }}</p>
        <details>
          <summary>Raw file details</summary>
          <p><strong>Raw Path:</strong> {{ tape.raw_path or "—" }}</p>
          <p><strong>SHA256:</strong> {{ tape.sha256 or "—" }}</p>
        </details>
      {% elif tape.status == "New" %}
        <p>No raw file attached yet.</p>
      {% else %}
        <p><strong>Raw File:</strong> —</p>
      {% endif %}
      <p><strong>Backup Status:</strong> {{ tape.backup_status or "—" }}</p>
      <p><strong>Tags:</strong> {{ tags | join(", ") if tags else "—" }}</p>
      <p><strong>Notes:</strong> {{ tape.notes or "—" }}</p>
    </article>
    <section>
      <h3>Review Queue</h3>
      {% if review_items %}
        <ul>
          {% for item in review_items %}
            <li>{{ item.type }} — {{ item.message }} ({{ item.status }})</li>
          {% endfor %}
        </ul>
      {% else %}
        <p>No review items yet.</p>
      {% endif %}
    </section>
  {% endif %}
</section>
{% endblock %}
